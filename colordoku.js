// By Jasper Camber Holton. V1.2.4
var seed = Math.floor(Math.random() * 100);
function RNG(seed) {
  // LCG using GCC's constants
  this.m = 0x80000000; // 2**31;
  this.a = 1103515245;
  this.c = 12345;

  this.state = seed ? seed : Math.floor(Math.random() * (this.m - 1));
}
RNG.prototype.nextInt = function() {
  this.state = (this.a * this.state + this.c) % this.m;
  return this.state;
}
RNG.prototype.nextFloat = function() {
  // returns in range [0,1]
  return this.nextInt() / (this.m - 1);
}
RNG.prototype.nextRange = function(start, end) {
  // returns in range [start, end): including start, excluding end
  // can't modulu nextInt because of weak randomness in lower bits
  var rangeSize = end - start;
  var randomUnder1 = this.nextInt() / this.m;
  return start + Math.floor(randomUnder1 * rangeSize);
}
RNG.prototype.choice = function(array) {
  return array[this.nextRange(0, array.length)];
}

var rng = new RNG(seed);

function pythagorean(sideA, sideB) {
  return Math.sqrt(Math.pow(sideA, 2) + Math.pow(sideB, 2));
}
var canvasid = "game197";
var canvas = document.getElementById(canvasid);
var width = canvas.width;
var height = canvas.height;

var ADHEIGHT = 90;
var less = width;
if(height < less){
  less = height-ADHEIGHT;
}

var TEXTTYPE = "bold " + 42 + "px Arial";
var last = 0;
var stage = new createjs.Stage(canvasid);
var container = new createjs.Container();
scale = container.scale = less/1000;
background = new createjs.Shape();
background.graphics.beginFill("#b0afb3").drawRect(0, 0, window.innerWidth, window.innerHeight); //
stage.addChild(background);
stage.addChild(container);
var speedfactor = 50;

//stage.canvas.width = window.innerWidth;
//var canvasHeight = window.innerHeight-ADHEIGHT;
//stage.canvas.height = canvasHeight;
leftbound = (width - less)/2/scale;
topbound = ((height - less)/2)/scale;

// red, orange, yellow, dark green, light green, dark blue, light blue, dark purple, pink
var colors = ["#f50521","#fa8907","#fafa07","#2e8008","#33f707","#214bcc","#07eef2","#9b5bf0","#fa75e6","white"];


var ballSize = 37;

var selectorBall = new createjs.Shape();
      selectorBall.graphics.beginFill("white").drawCircle(0, 0, ballSize + 7);
      selectorBall.x = leftbound + 100 + 800/20;
      selectorBall.y = topbound + 900 + 800/18/2;
      container.addChild(selectorBall)




selectedBall = 0;
var selectorBalls = [];
var text;
for(var i = 0; i < 10; i++){
      selectorBalls[i] = new createjs.Shape();
      selectorBalls[i].graphics.beginFill(colors[i]).drawCircle(0, 0, ballSize);
      selectorBalls[i].x = leftbound + 100+800/10 * i + 800/20;
      selectorBalls[i].y = topbound + 900 + 800/18/2;
      selectorBalls[i].index = i
      selectorBalls[i].on("mousedown", function(event) {
        selectorBall.x = event.target.x;
        selectedBall = event.target.index
      });
  if(i == 9){
    text =  new createjs.Text("\u21ba", TEXTTYPE, "#000000")
    text.x = selectorBalls[i].x - 20;
    text.y = selectorBalls[i].y - 20;

  }
      container.addChild(selectorBalls[i])
}
container.addChild(text);


// Sudoku game class
class Sudoku {
  constructor() {
        this.board = this.blank_board_array();
        this.ogboard = this.blank_board_array();
    }

    blank_board_array() {
        return [
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0]
        ];
    }

  // I can't figure out how to get this working with the "set" keyword, so making a method for now
    set_board(board_string) {
        this.board = this.blank_board_array();
        this.ogboard = this.blank_board_array();
        for ( let row = 0; row <= 8; row++ ) {
            for ( let column = 0; column <= 8; column++ ) {
                this.board[row][column] = board_string.charAt(row*9+column);
                this.ogboard[row][column] = board_string.charAt(row*9+column);
            }
        }

        /*
        if ( ! this.puzzle_is_valid() ) {
            this.board = this.blank_board_array();
            return;
        }
        */
    }

    get_board_array() {
        return this.board;
    }

  get_cell(row,col){
    return this.board[row][col];
  }

  get_available_balls(){
    let balls = [];
    var ballCounts = [];
      for(let i = 0; i < 10; i++){
        ballCounts[i] = 0;
      }
        for(let x = 0; x < 9; x++){
          for(let y = 0; y < 9; y++) {
            ballCounts[this.board[x][y]]++;
          }
        }
    for(let i = 1; i < 10; i++){
        balls[i] = true;
        if(ballCounts[i] == 9){
          balls[i] = false;
        }
      }
    return balls;
  }

    make_move(row, col, value) {
      if(value == 10){
        value = 0;
      }
        this.board[row][col] = value;
        let willDropConfetti = true;
        for(let x = 0; x < 9; x++){
          for(let y = 0; y < 9; y++) {
            if(this.board[x][y] == 0){
              willDropConfetti = false;
            }
          }
        }
        if(willDropConfetti){
           wonGame();
          dropConfetti();
        }
    }

    is_legal_move(row, col, value) {

      if(this.ogboard[row][col] > 0) {
        return false;
      }
      if(value == 10) {
        return true;
      }
      if(value == 10){
        value = 0;
      }

        // check for non numbers
      // weird that JS match function doesn't put quotes around regex
        // check row

        for ( let i = 0; i <= 8; i++ ) {
            if ( value == this.board[row][i] ) {
                return false;
            }
        }

        // check column
        for ( let i = 0; i <= 8; i++ ) {
            if ( value == this.board[i][col] ) {
                return false;
            }
        }
        // check 3x3 grid
        let row_offset = Math.floor(row/3)*3;
        let col_offset = Math.floor(col/3)*3;
        for ( let i = 0 + row_offset; i <= 2 + row_offset; i++ ) {
            for ( let j = 0 + col_offset; j <= 2 + col_offset; j++ ) {
                if ( value == this.board[i][j] ) {
                    return false;
                }
            }
        }


        return true;
    }
};

line1 = new createjs.Shape();
line1.graphics.beginFill("grey").drawRect(0, 0, 800, 5);
line1.x = leftbound + 100 * 1;
line1.y = topbound + 100 + 645/3;
container.addChild(line1)

line2 = new createjs.Shape();
line2.graphics.beginFill("grey").drawRect(0, 0, 800, 5);
line2.x = leftbound + 100 * 1;
line2.y = topbound + 582;
container.addChild(line2)

line3 = new createjs.Shape();
line3.graphics.beginFill("grey").drawRect(0, 0, 5, 800);
line3.x = leftbound + 148 + 645/3;
line3.y = topbound + 50;
container.addChild(line3)

line4 = new createjs.Shape();
line4.graphics.beginFill("grey").drawRect(0, 0, 5, 800);
line4.x = leftbound + 630;
line4.y = topbound + 50;
container.addChild(line4)
line5 = new createjs.Shape();
line5.graphics.beginFill("grey").drawRect(0, 0, 5, 800);
line5.x = leftbound + 100 * 1;
line5.y = topbound + 50;
container.addChild(line5)

line8 = new createjs.Shape();
line8.graphics.beginFill("grey").drawRect(0, 0, 5, 800);
line8.x = leftbound + 100 * 1 + 800;
line8.y = topbound + 50;
container.addChild(line8)

line6 = new createjs.Shape();
line6.graphics.beginFill("grey").drawRect(0, 0, 800, 5);
line6.x = leftbound + 100;
line6.y = topbound + 50;
container.addChild(line6)

line7 = new createjs.Shape();
line7.graphics.beginFill("grey").drawRect(0, 0, 800, 5);
line7.x = leftbound + 100;
line7.y = topbound + 50 + 800;
container.addChild(line7)

let game1 = new Sudoku();
let games = ["019200600502000708006000050000070530000000001001359000000000920000020307000761000","049000007000008000080040029005000304000704108000000500004309205000072003000500000","040200106009700000000040000090050200806002001005690000000001004000004920000580000","300400000009000000000020100004009300910000000006004081008030007040008062620100009","006005020074010506010200300020000000500001007031000000803000000040000001000742080","000004000000209180000080000000910800000063050030005904000098406403002000500000290","000200000400900000300000508090086052003497000000000000008004900005000670700020304","040050000070286005002730080057009206000060030620570000000000008080020009000000000","000004000003001000080000000510060080000095001607000490000006547030000100400019360","002000876005900200040006000000000000090040000560000090000400020000501904008207051","008002000730000040000030000070010063003260570100800000000000000201007080080504030","500896070070300400600100000080000009900000005000000000001004657700003004090008003","000100000800235100003000072064580000702000080105006000006002000230050000000710000","860910004400050700000706010020500409905000000780000000040000005000000200010002860","806700500700095002109008060000000000000000290010080470400100980000000000600204750","009060012501400603000500904000300020035017009600009000000905000000020000002734000","000137800008006091000000620007800000000503970000000000802700000100900005600008100","060390008740081000000657010001003509000000000400018370000000104000406005000000900","000000002040000060008000000400000005026000039709200004000050090090307026503009870","000009004009810307000327900800000000073000000000008000900000070680001209030060810","050000407340000000108070060000690805570004000064300900005000001001080006000030000","004000002000070000000010000801400607030000080006001034500002000040780500708005126","000020406000004020000860000006540080100000007000000352000051060860030700010002000","007800009004207108015900000000009000100000002069005007008006000956000000700000405","000000804000000070390008010000010040784090005000000600005000000019405006800000701","900005020500630000004087005287000006005400007060000008806000000700050002023000000","320400000706000040001097000000000003000210600000000010240703800600900400070060032","070030690010006007800009500000000060030000000000002080195000003260070850300090200","000200036000000000800700002090000000108000367002070010040360900001040000006809041","800000605005090007100500098090856000400002000000070000608000000002000400000417000","009003000007820009180000000500900008000000000000305200008002307300571000050000040","092100000000000000650000809000000900080609020020507081100042000009000400007905006","060000000300900648000050000008040503000082001030000060050020400000010092400000050","000000205000040090000200030010480050057310004020900007000000109000000020941800700","000000000000200004009000070614000000730000902500003060050006047020009536300004090","000805000000007900000000000010000000089061000520700061070009002008050070050204016","170000050040560008200004190000000000007800405000240000004750000900000000065089000","000615000080030002500080700000004013000000500060300070700800000000050268000020400","026009740000025060000700085009078024000060870000504100108090000000000000902000000","200600000000800007009230008003000905040000000050049072090060000300072000506300000","100058000007900020000320850010600002300080007000010090020700000060000300000030006","004030000060500018081000370000045000000790130105003907009000086000000090600000000","070020008000000407040010920004962500020704809600000004900206000100050000000000000","000200800704800605000060004000046000000100900000750010570900001400085009008010000","000305000000040000000821000035407080000000030120008700000500870206070500050100402","410000003000203700003000050702000000584700000030000000090040500800010409100580000","008002000700530000301098002009010870260005090100360205000087000600900000000020000","000604570200030009703005024000060000090000000007200050005890000008040900300706080","000030020005248730000005000700003600000450007340102850000000004800017000000060080","903000065004083000006005280009000000000008000750002000040020000005006002008409007","600000040000000000080000065090030000324069000006070080000500007903008006002940850","580760000000900000009021000070650021002000040400008750000800000006000079040000006","500700081000005046070084000005109370008000000060070005604300007000900000000000100","001000094000020370000010020900006400006034100300008000000900002108000000007300860","100000300040000006000000840508370600400860510000002030000000005000480702700050000","005000070060000010300800500001036700000708461000005000280000040500000603000000108","000000020600300005000520000000700080000650004500090006080960000002400700007800360","050030080000050002000800040004200300003007015000086700210040000000000050700001203","001900000905700008780610090000000800000000004810005602000000765000006000000124000","532004096960050010000200000010000000000000005300002009000096007000700040075310000","200080000004000037000000904803000000061002048090007060029070416070000083600000000","000400961064010000500300400002034706030790510006100000001000007003000000000000690","000509300070031050000470000000064010014200035000000790000000906000040000047056002","007210048300007000064000000801000620600000009000000700000700902010000000403100807","000000500040000008000003010050000000394600100806520930520008340001000009408000061","008070030000000204200065090000900008000000000000780000607000459300500006082690007","800009350030000904040005002001003209000018006056402030100000000000000400900000608","050000000600000090400000726900080070500060180006004000000100059007020000200008040","094050002000001009106800000300000000008600000000205000810000405200900800009000060","607000005093007000000000000500100960900078040041000830700006000005000010860009000","000005060600927000304800009080050000230006000000700000420080000009004036700300000","806005004070400080040000001000700053000000000000008000062050700403070206007210040","000000270000020500000800000080005020000070003400002901090000410701000000008350009","600000500080090007500080200006200800978500040040079000000021060000900000000704000","609000140420000070003207000037000006090003000205000400050010304700000920001000750","001309000890100000000020000000710080608000100400090060760002000104830076000000000","084000000003000000050000083010200000307000002608070510400702305500160200000053100","000070403650030080107000506802000000300608000000000700060083020008145000000000000","500700923041000005000000000000304002007920001908000070302400700104500000000000000","000000060430500200700300051176003490050000000394000000002000600500040100000200030","103000670000000000007008000015020800608090023900000000002601080001007500000950000","082000007000500000605007002003060005000080020000790364000906053000370940000000708","010900034390460000006000000004000003700000000000657040041000008008070050500130000","080000090213000005500800000705000000040001750000009200150000032800000070030450008","060000302128000004000010000045000007030800400070000060000000056007000100080200070","070004508810709064003010090407300100108000000000000000900507000000060850304100000","000100003681000000000000000018006200000070900590030016200007000070598060006003005","725000300000000000300010009090000700001002050004080901450090030000170820000050000","090000600806000470030060002003090700020000090000204103900002008000700061018000040","500000000370008000002050408609000030700000200000000800063540070900082050040600900","000067500100049200503002000000701000004600000009000703200010300601200900050000000","029006800000000074803094506600000007058040000004000030200050000000000005095000240","002035017001040030605087000700004021000000000000000563900000000000000070027003004","130090500025800000000140000080000070000000109050700300007003021000006904000000000","820007600907000431006010700002400080600003900003879100200090000000000000000060800","600708400700000000009026850000000000062000070000000521410000700085090240000000010","000760000000000000000493000000000094105080007090001803500007060069000000081004700","040005096000000000050000004500041980080600700000709003000100000009070000017064035","406008031005000640070000500502001080340506000060084000000800100600003000000705000","000003040000000100004000097018000503020008070500000000070000028080010030300805400",
"000000070000000004120000080080700900004652000500040000000000000060800200297000500","000910000610800000000500970000000035300000060700090000070000506003005800041060000","070406090003059007096002504030024000000000105005093400000305009000000600700000300","013000900090080203000009057000020000000300500040007000800050020070200100900078040","000041053000000080064000007009050801050730094008400070030000000800500040000070100","040720003003010490000400502000230970000046300061000000700000209500000000000090600","591000300800090100030000000000000047300504008080010000000070600400000003000003894","604000090008700000000091000020040000007003600186000900079000160002010000040200370","000500900003020000000100400062050090309004000510070306030400205000206100000000070","000600010100000400700200003604002000000800004000706800000010250010300600000507080","003087000004009207001000005000000001020000470000034080045001900000270004000003000","800000600000000090700000000007300000460090038093000200030207004002645700000080020","200168097008009000041700005000017900005000012000000008000600079000591200006002000","000008000008015740040700200000170060000090000971500000807002000009000000200451080","502000000000364000000070408010007002000082504006000000000000000260050000000741003","000000000000416500000008093560040800000000700401857600600000007000093400000100350","000084500000000200040251000000020043910600000000000008300008006009000031005000000","401000008000000105539000027020004001000300000700000050005270000300090000074003009","032780060060009801010600020000090030004012700050070008000000002026000000000000940","000004000001000307000000190000500603000600009603081000304070000000800000800960750","020000090000070250030000006005300000080205700100006020090702800000000570000060003","864000002105200000003010004000000006000000130000000748000056401600000500020180060","000800903005390400009200500001000040340000200690000000000400050403008000800036010","109000000074050009000000050800000700030000000006105000001000630600300847000046000","700012509000700400520008000004000700308005000097000100000307020009400000000009000","007106040000040000000000000800000010070009500906030000104500870000300100030600905","001000070060300500000608041000040007400805060000100800000730016010900000600000400","010030000009001408000650003530006800908000301000005900000978000000063004000000090","000000730000430000020106400801000007006801040004020060000000000040203500000580100","406070000030000800087209500004090000060000000008005000000783400000020060000004237","102030000090005008500002900000700600030020000806090000019000007000600000350180000","000400968000026730070008001031004070008300000400072090000000600020760300000000000","001007260005000000009600710000000020007029000000050470000506000024080090080000040","000008000987010002063000900200530000308026000000100000002890501000000203070060090","000030000000165090086000001004000000008700305670049000050000000003614000901080000","060002435200900080000000000100000560000500001600000040031006000008000900050109004","500100000006002704002005060001004006000720000070000000003000000005000018040056023","400501000000070080009004560000090070000000000000058000004010096005300007700806103","200000000850000079000090642007200000000030090000040860700509000000476003000000020","020400007001230000060000093289700040103000009000000800004003000700000002000070461","140000085000090040050003972000000008980700000000450000000010060230087000705000000","400390200080700001090080057300400805000000090000921730000000000000000129100200078","008160500000030000006005000000604070090000400085070090000003904000400600900010357","030000000790108200000049800000000302300264100080070040000090000000600087000803960","900000020000028000065107008000210060000809007800400001000000470080000006006001009","190005000000060000038400009002500008000000020000000300000200460904300001503800000","350000070704050000001049000010004980570031020080000300200900000000003800000000003","000000000040000580000900600100006900020074010064000702007200000010009258090560100","100005027000000800000032010000008003000050900700900206000007000030800000006210058","000005000000980000000004100008050060001003050200106403034090800005300010080020000","200000000005000000300504100040630002020005074090700600000901000000260900100000300","000780062000000008060000001000000006400002700000090230003800610706004000820079000","000019000030000098000020530608002703290500100000708000000000000009000816000003072","002005000000301400000470090300500010108000043000000007800100034000002000000009050","000000000420075890786090400603000000000740000005000004000009000800050002000600705","000010080800700040010600002006820905750000400000090016007000009000060800000001050","425000000010000006070500010568920000000001000004050009601000407040000091700000620","000000000600871005710090060000786000500910000000002809300027000050100000190300070","800000006049000200206000470900010003010070000600000080002060001498000600000790030","802790006000100050600080009003000800000600030000200007007003005009007020200510073","600000082080430105000000064018002000207601003000003020100508000700000000006204000","050000009000002003000590000006400010300060700000305090003070504029004000760103000","700000003005300914200010500061007000000000400000005200000000040306000009409200050","001760000042000010000000006506070000300942605020000000034000000105030004900600200","400801000060940000001007600100000002030600080904700000000308009049002000002000003","009046200300002010000089006007000064030000000000000070002000700000701020080090400","020010890000000070100204500000000000079000000004105000806700200010068400000450000","090200103160000420030600508906024000800000000040105000000003000384090000210000000","600000000000000001800000240400060000280701000000090008006007104300009070704028096","700000060080010207012630008004000003000300070000000890000020000027400010893700020","050006020900000000038000000090001000675009000300020000720600530000007081500010702","001000000000000300000509000027090006605307002030608009002910085000006021000700600","000020070000000000785000600098000003003040000000830209000000560306007008200600907","000001400007090000809000000000250800000000300185700000470080103090130200300000590","450200070007000080000830000580710003000000000000023400002301000000004009300050000","090000071700040025000000400900015036005000000407096000000000003000000910210070064","008000005170600800000500164200000000006000070000010000062008090851060002009000007","503872000000000000100600000700006405005080062400103000032700050000028070000510000","000007580200000000000146000000010000002364010000000230700030800800070000010085026","400000037800004500030200089020007090000401005001050000000000000090870020100009000","108000030000003205003906100000070000000000009010005020800050000007000950300600010","952400080017500300004010002000200000030000170000070054000008037000020805400000000","040020037000000902030100045090000000600000071010402060500040000020096003000530200","200007000040000001000193600000000005000056413000740200700030509000000020004201000","006010000000800000000000200070030000004601070900000340020004001009003802083002060","040000205000500700800071400470600000000200068050009000004005000000000601061000052","010090060000000800528007001060000900400081000802000007001000048050000200600900000","900006000000000100040100096000000070000290410000000500600502700052407008410900200","600005980000000006501002000000890704107060002000000000050007000900100000400020060","000090000106007000057000600082700005000050080600000400200000501068000070504200069","000000503000008009000240600809050362004000000000020005400092700000500890500870006","000300008000000120094800003000000867000000000780000200600030000030210900200906704","830005060200801005701020000000400000000060030400007010100000003000586200000004070","067201000020070045000350270000000000006000050000502401100008700000000008200700004","009070000020004070046109000008000590000500000600001704002950000000026040000007900","030000050060001000007050000609010700700040300000900008386007400000300000410000600","604070300007000060008040920200586000900020670000000200300000000080950000002000050","300009000402060001070008600030000007000703980000800320600280100000907200000600009","020000007760000380090307610271000000000940000000008000008000920040809063000100000","040200000000000003070030920700000050530040010001083000000410200080009000000007591",
"060050000809000050100080700002060000700000500500010040025400090000009006080070000","096000100200000085000000070001000000680001090000708020904010002010800749000000000","060000000000000010457000060020000008800004000109608050070001520200800096000400100","810094000700530000030001009000023040000708000400000007000000004200407051000000390","010020900002007408900830020070214090000009000000500000001700250040000000000395040","006000200140060000970000000000025000200710040051006000000000950064000000000008701","000000402902006070100000060007105000090400500810090000050000600060200107000000040","400009050600803079000060000004300000000016038000000100003000007009400000001005960","095000180000035000200000000014053000000006010000409230040000600000000900028001400","170003400040980060030006007000000080000000009080400103023060000000000000098000020","360521008700083000000000000290600085070005010800010030009000623020000000000000000","004750000060409728000000046070900000810000069026001000040008910000020000000000000","001200500000000086006507030180305000700096000009002300000001690000000107000000052","309010400600000000070605030504000080000340000000060900007009100000000500900830007","000340000002000000009080002106009040200003560000000103405000090001098000900461000","300200090000900060700005340000046000000509004030007002050000000070000109620000000","900050006500003800036002041000080000000106092102000050060000084040060200000000000","026040000000300040300700200600000000007020000500800000008510003030070061760403008","082004600007051004000700000000600000708000000251000000034000800000006007000408105","000070500060008023002140008080053000130800002000000000008000004000730006000001000","056000000000706000000080000021000500000218040000050080480000120100004790905020008","300000506004000910060001007070905003000070000009000060650087000008103000000460000","000902050000086000068000900904508100170094500002100040400070000000000400000050071","000190000003000000094600305475000001000901000000540000206300900000009000001070600","000060701000000000090745000000000010009003470053900000304070060170000000000300200","000800000002000700376100020200300008008010942409006000004000019000000060100000207","000000020000000000070050090200908070000020059190000400400100060710009800980004007","002005300500970001000063200610000930070000000000014000004000000390006020700400005","030050009000108305000000000008009073000000002103260098900070080000900006000810057","060050200090000006507080040001007008940020001000000000000000080014000600280500090","000000700000400000469200001500089200100000000200010690810700400040905007000000060","000260000000709380000000600620003000030050102008010003076000098500000000000000570","800001050060000020002000070004000001010002400500007000040300600703000000006508010","015000380073018025000000000080000700600005000007400000006850043002030000000700010","005080900082907010100230048240100087000008000350000020500000000000300401000000000","870540000302090800004800020080050003209000000000003070420089060000000000650300000","002007000004105080800000140000583000600000000000000300030400078000020010100630500","000005000005060430000003002160700000000000004000600050048000021000200047030170600","210009640049000000000400003084002500020060400065003009000200108006800090000000000","000004002000000000020600080100000090080709261007506000008060000040107000060002479","000800043080070009090010020000008010010020038007350204400007080000000005050000000","004003070901650000000000609003100700005406080000008006007040000500070100040000000","030050000600300094007004308109000040586900000000000000063090007000030050090600800","080000200003008000000000000800300009010200040027060010000610000100080093000730068","800036070060007003034085906003800000400001090000000000049000100008050004105060000","007020900000000718009000000200038050050090306000057092600000003000081000008005000","000005804045100326900200000000003008090000402010000000000009500056400000020000001","005920000002040000000037060200090050070006000000400107000000000619000000004100200","100000063000006400000000000800005000059103200004260001306002008040001002020800500","200050083000000016831006020053207000008003001420000000600040070000710000304000000","080000000302000000010056009000200805000034090000000130053640200060390000800000000","060000009005030042800001000000000020500000300000003901010309008004060030680002000","002010034780000010000000908000040502000007003050000840070000000030005020209034100","090854260000060830000300040002000004800401000006000380040000000000602090500000000","100000000005130678070000050040090000008000096000750400300409805710000040000000000","543000001000000743700000090307000000091034600000076900004000056000000800000069070","900050000305000001010000004000570000000640085400090000509000018071000030080000497","000040000004000700012805000000700020500063000007000803100000400020630007600078000","009003001003100006700000090631000000020300700400209600002000007305004900000005000","020090040030107902004000500092000001100000030700010009009800204847000003000000000","000009730010400020000000600007000000004100090309860017000000200400903078000670900","570000002082000000000030000130000700029700380000100009000570940094820070005000000","400500080000390002205076040000000000060930001007080009003040000806700000000060000","200000300003078500008050074070000403000400189014980007000000000700030805300040000","000600000609000050000700800001002560056000900000000020700810000925007100000900040","040290080700000160000050000000005000900020800024800005100000006000000070069002004","000700060003102400000090713200000040005007090700000200000060501301000004006000020","000500000003010700097400020580000000000090050300204010100002070000000802030000900","004000230000000000000174000000800145020005000030400007100067000050030000060200300","000038904040900800700000030630000000000000620010000008400000000260400381900010072","040000000050400190100030820003079000800300900000002071000700000500841000000020000","010000000000100000720003600003000200000004917001609040000806090098040100300001400","000009001300200009000360540000010007076005000050430600900000000200000000003040200","000020097000090800007100600000000010189300052000000306032650100070000003005000060","087090001203008000905102007020000018000001060030000500000009050100000003050003792","098030600020070500403200009200350096000000030000000020807000000000000060346700000","300800040007300801000002050000000985700000000043509100908000070500020003070000000","100009350009560000200000000000030008395000000080200000010700600920000000703800001","083006050000873064000015000090000078030009000500000009001050700070000000060480000","000200040028000000501080703002000035080071000000004100900750001000000970000000002","000003016003701200000000090007800000000000809150000020700030080090000000500002170","000600200003000000800750360040006000200004000050180070007000601000300007500040000","000000040050000100071600502003000004600009000104023006000000700000530400200000019","007800100084000602631040000012037080000060420040000001009000703063000009000000000","095000000020009007708000200004500000000280090280300070540000100070800000001000004","080000052015400700900200000003050800000000003000014070007000108000008429000100030","002000000000040000000010090009800030106000000480000500300690200061208300020500960","000480079200050810000016400167090080000000000459000000005000000716000040800007150","050040300092000050003020014008000540000018000000000000580002070009080003007009000","000006000805000000071000000000305000900200506003100079060000083007000090002500100","070400180040070000003008500104890030200000000000150900307000000451000702000000050","210000007009000018000000235823040000500000000400920070050100300080000050000030082","004050607070820500080070000100007000000003861000060300000000205600000000305000040","500400000000069200108000004000006400003010090006500120000000000000350800601004003","000040973502000000000003520009050030406902800080006000040000000000000007060008090","000006002000007000008340750700400806000000000010628004070003000320000500104050000","000001052000008070500620893090870020000000980000093000000100200006005017030000008","500000009098006000410900750200098000000000046000704000080601090000020000005047000","000000048000004237000000500000083090400750000000000304130502900004070020700039000","000000400400012600020006008300000100000060009000039280090000001200108053000500802",
"003006057000000800000700903006000038000000040480000700069053400025800300700000005","000600001300001709020030060704900000290000008103007020000006000030000000007140000","000080500001900800900000067010076000650000002040051009000800200090004000708000000","700015068001300005000207301040000003020050000607002504008000000153000000200000007","000090206230100050005203710000000604000000002027300000010706000706000000004500000","009010005000700000000406000000108500400900130090030087045003070008000000163000400","000710800020003906050000700003800200000200000016000000080000600360090120500080003","079008000100000500683000047400097000090000070800603000060970005010800900004005000","009300001000010600000900370000100000310050706060700000000620003024590060090000002","000603005530070400002900000970000004000100790000000610300000500057004002400000000","200649030410008009000000000050803060000020390180000000000500000500000043000006020","709000060020800007040005000860340020003700006002050084080009000030020000900000040","000000100300210070200000004400000390701090080830401050900000702008009030000030040","007600020041070069900030001405009070070012006300007000020000000094020000003000100","730001940009000800000090020200073006100008370400000000004000000000026000000100092","006007402490005071020800006000500064000070050000004100000060000060002900150098000","700000000500007980091025300000070060930010000020000000006009108000801090000030650","040000300300009072017003000000090604702000080980600001070006400000107000100000000","108030000000000060000905800409081000017000000000000004750040130000008070083006500","800000302070508010005420000000174028001002000080030000000000030400009000193005000","000602009008450603000039000826040000705980000000205006002798000000000900307500000","970504300600000000054890007700602000005087409000000050080000030000039048000000000","090000000007003400008060001460000800000009063083600000000000040300100200209040080","903000827002090000780003500000042050000500409500080600070008030000050000009300000","020001670080076000000400300000860090010000800070000046000007000004120000060308120","000080105001000890000900070904000730750001900000006000408070000300000510070009380","300001002000000008008300000000000005160090007020106000200003009000900256500800071","700089500004060980000000000001700060007000000568000100000000090405090618600300050","091000000000000002004705000800300900000040000050009014470200000080500090005074000","020100000400002000079600000000000790040050600056700001000070458000000026000090007","000000509090308201100002060200900354040020000000005000416003090000004030000050002","000001205400002700905700040800005000079300050030000092701083000000000000308500000","004080000102003800030172000007008000581304020000000006000001400803000000000500000","700020034003050000080900206000490000026070800090008005500300000000000000030060020","000970240700006005000005000046008000570020000900000570050010002028000400600800000","106000850750000601000000009900004700000000000060708430000000004670905080039600000","000000200108000035000040860020000510064080900010009003600000300905068000040000000","003201000008070000000008053000600070706082300002030010000003045000050007000016800","010009000508000009760080000002006084000050000480010906000908070070000000201400008","054190280860500000190026003005600130000000000020000900000405002000030000000208090","400620907000000000030070040540100690000250000090004200060000504050000003200700000","000000008003085042000073900000000065000042800009500200200009006000030080400000007","340060208061000090205000001150200000000003960006000000000540000000000082918000000","000750020000103008307900500090000000615090000700000000000000000069000710023608009","050300000836040005009600000000170000385000090001000450000000060503000704014090080","059764000600059000001002500026000090140030000000006400005000341000000600300005000","000020089000050006601040500060000000900200000000080020038410002000000100005008060","000000300009700006005000009007500000030000200102830590603205080000080000900060012","000010075000000004180050620000000060403006010700000203001000000800040352024700000","000920000000400700010000005004700000007591000008006900005008600020000081080000009","001080000080509000000002403000005039030000000000010004068023005190600000200000800","800000000004000250050020074270800900000100486100009005000091862000007001000080500","540072000000000000016400000760901540804000020090000076620100000050200009008006000","000200060001038027020005000048000300000010000000002001002004000650000403310060008","000003000037650400050004800690020000004800006008300920006000300000907002005000007","000930062000008000000706003008307005090010007050000100310800506000500070000062000","000000807007000354000000060000004080609057020000000705040960000038002000206300079","000200000001080007800040005089070100014000008500300070090002001000100040070400023","000000030000090200730400000904076000000000905000200800060780459050000008400020000","420301006000085400000000039050010080009000000008004960000430210000000540300008000","600049000002800030001030000070000000000013000094000072000060000407000026310470090","630000400500900008004005300060200150000030004020004000000010000010000823250000000","007050000000004869490100000000000056050030010004001003900000700706000300035008040","000000000600350000078002130010000300035104002740000060300000008000800724000007000","000800000031950008000001030009340000004020000008000600006000020100506083400090500","000902000000000200200100038000450070005700801000001004904517080070000009100390540","000000030000000000095000806080600000704025600009400780040200000008703059007506300","018900006590006200700000501000080000360009008000000050070003900600000002059602010","000040000067000034208003001006510200001007000000804000000200007070030060100050800","000003006006070000840100000008069010760000000030000400053894000000005100000730000","000003705460007000002010006000060000100024000600000230009000400700400651000000002","680000450090800007000670100035090000000000000800060910053000000000003700100000609","000000081902048705030700004500400970800000050000000003704001009000820000000000007","380700405070560003206000170100000508030400000020001700000086050000900010000000800","020000809800000105010400000070130082103050900000000000780040350504300200000020008","001000800000008904000954600000000001006700000080090200000080109000106040050000002","506040020098700000007000045030506200000800003000007000070268400000900030002400800","800060000000000007026100050030004500140607030700300200001240800602800000000000000","780010000000703005105000000901000008000000900230106000070320000000007609002600080","200007600047000502600020001000210030000709000000000900010040756003100009009006000","180090060700001200000000507603000000020500900070800000901067000000002005000000600","000000050200000700057608210000000170800000063000002508180500400030807005060003020","006000000030408000000907080000590040000001090005800671503000100100000054008600030","000196000000000000401530009106003050300904006504000020009020401000000030000760005","463095000910000200000001000000000000090000530348000000105009480080300006020080900","000180003006002890809000501100027000000800070020360050000500087060000010200000005","037064009601050700090000000005009410070000006000000537000000005009200040764000000","000000009000009610100030025045070000001000040006200007000010072207000050000400903","000940605560700194000006003010070000600000000000120000000010402730400006041009030","000705000040020000000080100905600010000000005060001008002008567007009000600210089","000700000480000065510608070100070000000002380040001026020000000000300050006100040","806054007027000000000200000008000000351000000700403050480012006002068005000000030","340000000005070000006300040590020000000630000800597003020008006607200500000000900","000004590300000000000150640400080150800910000600300208901638400000000000000000906","300000090050084000170060504000790008000500400006001000000000007000009306030870000","300000020006000900080600030570006240490020000000300000704809000000000003209075000","000020003000904000402807009504000760300000040079000000000065000600700208000290000","000009000200070009600200030000000004010546000590010002000403201960001000000000000","090600000000009001007810000050100207086050019700040060500020084008400502000060000","024090108800050000060008050200500416090000502001260000000000670008000000040100000"];
/*
"080100007000070960026900130000290304960000082502047000013009840097020000600003070",
"003020600900305001001806400008102900700000008006708200002609500800203009005010300",
"200080300060070084030500209000105408000000000402706000301007040720040060004010003",
"000000907000420180000705026100904000050000040000507009920108000034059000507000000",
"030050040008010500460000012070502080000603000040109030250000098001020600080060020",
"020810740700003100090002805009040087400208003160030200302700060005600008076051090",
"100920000524010000000000070050008102000000000402700090060000000000030945000071006",
"043080250600000000000001094900004070000608000010200003820500000000000005034090710",
"480006902002008001900370060840010200003704100001060049020085007700900600609200018",
"000900002050123400030000160908000000070000090000000205091000050007439020400007000",
"001900003900700160030005007050000009004302600200000070600100030042007006500006800",
"000125400008400000420800000030000095060902010510000060000003049000007200001298000",
"062340750100005600570000040000094800400000006005830000030000091006400007059083260",
"300000000005009000200504000020000700160000058704310600000890100000067080000005437",
"630000000000500008005674000000020000003401020000000345000007004080300902947100080",
"000020040008035000000070602031046970200000000000501203049000730000000010800004000",
"361025900080960010400000057008000471000603000259000800740000005020018060005470329",
"050807020600010090702540006070020301504000908103080070900076205060090003080103040",
"080005000000003457000070809060400903007010500408007020901020000842300000000100080",
"003502900000040000106000305900251008070408030800763001308000104000020000005104800",
"000000000009805100051907420290401065000000000140508093026709580005103600000000000",
"020030090000907000900208005004806500607000208003102900800605007000309000030020050",
"005000006070009020000500107804150000000803000000092805907006000030400010200000600",
"040000050001943600009000300600050002103000506800020007005000200002436700030000040",
"004000000000030002390700080400009001209801307600200008010008053900040000000000800",
"360020089000361000000000000803000602400603007607000108000000000000418000970030014",
"500400060009000800640020000000001008208000501700500000000090084003000600060003002",
"007256400400000005010030060000508000008060200000107000030070090200000004006312700",
"000000000079050180800000007007306800450708096003502700700000005016030420000000000",
"030000080009000500007509200700105008020090030900402001004207100002000800070000090",
"200170603050000100000006079000040700000801000009050000310400000005000060906037002",
"000000080800701040040020030374000900000030000005000321010060050050802006080000000",
"000000085000210009960080100500800016000000000890006007009070052300054000480000000",
"608070502050608070002000300500090006040302050800050003005000200010704090409060701",
"050010040107000602000905000208030501040070020901080406000401000304000709020060010",
"053000790009753400100000002090080010000907000080030070500000003007641200061000940",
"006080300049070250000405000600317004007000800100826009000702000075040190003090600",
"005080700700204005320000084060105040008000500070803010450000091600508007003010600",
"000900800128006400070800060800430007500000009600079008090004010003600284001007000",
"000080000270000054095000810009806400020403060006905100017000620460000038000090000",
"000602000400050001085010620038206710000000000019407350026040530900020007000809000",
"000900002050123400030000160908000000070000090000000205091000050007439020400007000",
"380000000000400785009020300060090000800302009000040070001070500495006000000000092",
"000158000002060800030000040027030510000000000046080790050000080004070100000325000",
"010500200900001000002008030500030007008000500600080004040100700000700006003004050",
"080000040000469000400000007005904600070608030008502100900000005000781000060000010",
"904200007010000000000706500000800090020904060040002000001607000000000030300005702",
"000700800006000031040002000024070000010030080000060290000800070860000500002006000",
"001007090590080001030000080000005800050060020004100000080000030100020079020700400",
"000003017015009008060000000100007000009000200000500004000000020500600340340200000"]*/

let import_string = games[rng.nextRange(0,games.length)];
game1.set_board(import_string);
let sudoku_squares = createArray(9,9);

var balls = [];
for(var i = 0; i < 9; i++){
  balls[i] = [];
  for(var j = 0; j < 9; j++){
      balls[i][j] = new createjs.Shape();
      balls[i][j].graphics.beginFill("white").drawCircle(0, 0, ballSize); //
      balls[i][j].x = leftbound + 100+800/9 * i + 800/18;
      balls[i][j].y = topbound + 50+800/9 * j + 800/18;
      balls[i][j].row = j;
      balls[i][j].col = i;
      balls[i][j].on("mousedown", function(evt) {
        if (!game1.is_legal_move(evt.target.row, evt.target.col, selectedBall + 1)) {
          evt.target.graphics.beginFill("grey").drawCircle(0, 0, ballSize);
          if(game1.get_board_array()[evt.target.row][evt.target.col] > 0){
            setTimeout(() => {  evt.target.graphics.beginFill(colors[game1.get_cell(evt.target.row, evt.target.col) - 1]).drawCircle(0, 0, ballSize); }, 2000);
          } else {
            setTimeout(() => {  evt.target.graphics.beginFill("white").drawCircle(0, 0, ballSize); }, 1000);
          }

        } else {
            game1.make_move(evt.target.row, evt.target.col, selectedBall + 1);
            evt.target.graphics.beginFill(colors[selectedBall]).drawCircle(0, 0, ballSize);
          var balls = game1.get_available_balls();
          for(var i = 1; i < 10; i++){
            if(!balls[i]){
              selectorBalls[i-1].alpha = 0.3;//graphics.beginFill("grey").drawCircle(0,0,ballSize);
            }
            else {
              selectorBalls[i-1].alpha = 1;
            }
          }
        }
      });
      container.addChild(balls[i][j])

    }
}
function print_sudoku_to_webpage(sudoku_object) {
    let board = sudoku_object.get_board_array();
    for ( let row = 0; row <= 8; row++ ) {
        for ( let col = 0; col <= 8; col++ ) {
          let input = balls[col][row];
            if ( board[row][col] != 0 ) {
                input.graphics.beginFill(colors[board[row][col]-1]).drawCircle(0, 0, ballSize);
            } else {
              input.graphics.beginFill("white").drawCircle(0, 0, ballSize);
            }
        }
    }
}
print_sudoku_to_webpage(game1)

// This code is borrowed from another website. Thanks google.
function createArray(length) {
    var arr = new Array(length || 0),
        i = length;

    if (arguments.length > 1) {
        var args = Array.prototype.slice.call(arguments, 1);
        while(i--) arr[length-1 - i] = createArray.apply(this, args);
    }
    return arr;
}

COLORS = ["Red","Orange","Yellow","Green","Blue","Purple"];
var confettiCount = 60;
var confetti = [];
var confettivx = [];
var confettivy = [];
var confettiv = 4;
var confettimin = -600;
function drawConfetti(){
  for(i = 0; i < confettiCount; i++){
    confetti[i] = new createjs.Shape();
    confetti[i].graphics.beginFill(COLORS[0,rng.nextRange(0,COLORS.length)]).drawCircle(0, 0, rng.nextRange(7,15));
    confetti[i].x = rng.nextRange(0,window.innerWidth);
    confetti[i].y = rng.nextRange(window.innerHeight + 30);
    confetti[i].visible = false;
    confettivx[i] = rng.nextRange(-1,1)/5.0;
    confettivy[i] = rng.nextRange(-1,1)/5.0;
    stage.addChild(confetti[i]);
  }
}

function dropConfetti(){
  droppedConfetti = false;
  for(i = 0; i < confettiCount; i++){
    confetti[i].visible = true;
    confetti[i].y = rng.nextRange(confettimin,-20);
    confetti[i].x = rng.nextRange(0,width);
    confettivx[i] = rng.nextRange(-3,3)/7.0;
    confettivy[i] = rng.nextRange(-3,3)/3.0;
  }
}

drawConfetti();


//Update stage will render next frame

createjs.Ticker.setFPS(60);
createjs.Ticker.addEventListener("tick", stage);
createjs.Ticker.addEventListener("tick", handleTick);

var droppedConfetti = false;

function handleTick(event) {
if(!droppedConfetti){
  dropped = true;
  for(i = 0; i < confettiCount; i++){
    if(confetti[i].y < window.innerHeight + 20){
      confetti[i].x = confetti[i].x + confettivx[i]
      confetti[i].y = confetti[i].y + confettivy[i] + confettiv
      dropped = false;
    } else {
      confetti[i].visible = false;
    }
  }
  if(dropped){
    droppedConfetti = true;
  }
}
stage.update();
}


function newGame(difficulty){
    // New game
    var d = difficulty * 100 + 100;
    var rand = rng.nextRange(d-100,d);
    let import_string = games[rand];
    game1.set_board(import_string);
    print_sudoku_to_webpage(game1);
    var balls = game1.get_available_balls();
          for(var i = 1; i < 10; i++){
            if(!balls[i]){
              selectorBalls[i-1].alpha = 0.3;//graphics.beginFill("grey").drawCircle(0,0,ballSize);
            }
            else {
              selectorBalls[i-1].alpha = 1;
            }
          }
}

var difficultyColors = ["#bafa25","#e4f218","#faa537","#8a0503"];
var difficultyNames = ["Simple", "Easy", "Intermed.", "Expert"];

var difficultyContainer;
function drawDifficultySelector(){
  difficultyContainer = new createjs.Container();
  var difficulties = [];
  var diffText = [];
  for(var i = 0; i < difficultyColors.length; i++){
    difficulties[i] = new createjs.Shape();
    difficulties[i].graphics.beginFill(difficultyColors[i]).drawCircle(0, 0, 110);
    difficulties[i].x = topbound + 1000/4.0 * (i) + 130;
    difficulties[i].y = leftbound + 1000/2.0;
    difficulties[i].diff = i;
    diffText[i] =  new createjs.Text(difficultyNames[i], TEXTTYPE, "#000000")
    diffText[i].x = leftbound + 1000/4.0 * (i) + 130 - 90;
    diffText[i].y = topbound + 1000/2.0 - 30;
    difficultyContainer.addChild(difficulties[i]);
    difficultyContainer.addChild(diffText[i]);
    difficulties[i].on("mousedown", function(event) {
         newGame(event.target.diff);
         container.removeChild(difficultyContainer);
      });
  }
  container.addChild(difficultyContainer);

}

var wonContainer;
var wonDialog;
// Draw a dialog to create a new game
function wonGame(){
  wonContainer = new createjs.Container();
  wonDialog = new createjs.Shape();
  wonDialog.graphics.beginFill(colors[0]).drawCircle(0, 0, 1000);
  wonDialog.y = topbound + 1000 + 900;
  wonDialog.x = leftbound + 500;
  var wonText =  new createjs.Text("You won! (Tap)", TEXTTYPE, "#000000")
  wonText.x = leftbound + 360;
  wonText.y = topbound + 925;

  wonContainer.on("mousedown", function(event) {
    container.removeChild(wonContainer);
    drawDifficultySelector();
      });
  wonContainer.addChild(wonDialog);
  wonContainer.addChild(wonText);
  container.addChild(wonContainer);
}

drawDifficultySelector();

stage.update();

//dropConfetti();
//wonGame();
